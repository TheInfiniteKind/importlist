<!--
build file for ant
http://jakarta.apache.org/ant/index.html
-->

<project name="importlist" default="all" basedir=".">
  <property name="version"                    value="1.0"/>
  <property name="src"                        value="src"/>
  <property name="build"                      value="bin"/>
  <property name="privkeyfile"                value="${src}/priv_key"/>
  <property name="pubkeyfile"                 value="${src}/pub_key"/>
  <property name="privkeyid"                  value="99"/>

  <property name="build.compiler"             value="classic"/>
  <property name="build.compiler.fulldepend"  value="true"/>
  <property name="dist"                       value="dist"/>
  <property name="tmp"                        value="tmp"/>
  <property name="debug"                      value="on"/>
  <property name="optimize"                   value="off"/>

  <path id="classpath">
    <pathelement path="lib/extadmin.jar"/>
    <pathelement path="lib/moneydance.jar"/>
  </path>

  <target name="init">
  	<delete file="${dist}/importlist.mxt"/>
    <mkdir   dir="${dist}"/>
    <mkdir   dir="${build}"/>
  </target>   

  <target name="importlist" depends="init">
    <javac target="1.3" srcdir="${src}" debug="${debug}" optimize="${optimize}"
      classpathref="classpath"  destdir="${build}" source="1.3"
	  includeantruntime="true"
      includes="com/moneydance/modules/features/importlist/**"/>

    <jar destfile="${dist}/importlist.mxt">
      <fileset dir="${src}" includes="
             com/moneydance/modules/features/importlist/meta_info.dict"/>
      <fileset dir="${build}" includes="com/moneydance/modules/features/importlist/**"/>
    </jar>

    <java newenvironment="true" 
      classpathref="classpath"
      classname="com.moneydance.admin.KeyAdmin">
      <arg value="signextjar"/>
      <arg value="${privkeyfile}"/>
      <arg value="${privkeyid}"/>
      <arg value="importlist"/>
      <arg line="${dist}/importlist.mxt"/>
    </java>
    <move file="s-importlist.mxt" tofile="${dist}/importlist.mxt"/>
  </target>

  <target name="genkeys">
    <java 
      classpathref="classpath"
      classname="com.moneydance.admin.KeyAdmin">
      <arg value="genkey"/>
      <arg value="${privkeyfile}"/>
      <arg value="${pubkeyfile}"/>
    </java>
  </target>

  <target name="all" depends="importlist"/>

</project>
